(window["webpackJsonpsimple-citizen"]=window["webpackJsonpsimple-citizen"]||[]).push([[0],{24:function(e,t,a){e.exports=a.p+"static/media/\u4e0a\u6d77_\u53ef\u56de\u6536\u7269_sh.94658c33.png"},25:function(e,t,a){e.exports=a.p+"static/media/\u4e0a\u6d77_\u5e72\u5783\u573e_sh.398eb4a3.png"},26:function(e,t,a){e.exports=a.p+"static/media/\u4e0a\u6d77_\u6709\u5bb3\u5783\u573e_sh.698541bb.png"},27:function(e,t,a){e.exports=a.p+"static/media/\u4e0a\u6d77_\u6e7f\u5783\u573e_sh.4bb2a660.png"},28:function(e,t,a){e.exports=a.p+"static/media/\u53ef\u56de\u6536.a300c01e.jpg"},29:function(e,t,a){e.exports=a.p+"static/media/\u5176\u4ed6.a0cd6ea2.jpg"},30:function(e,t,a){e.exports=a.p+"static/media/\u6709\u5bb3.83e3c360.jpg"},31:function(e,t,a){e.exports=a.p+"static/media/\u53a8\u4f59.986390c5.jpg"},32:function(e,t,a){e.exports=a(61)},37:function(e,t,a){},60:function(e,t,a){},61:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(11),l=a.n(i),o=(a(37),a(5)),c=a(6),s=a(9),u=a(7),m=a(8),h=(a(38),a(4)),p=a.n(h),d=a(12),f=a(2),v=a(10),E=a.n(v),g=a(22),b=a.n(g),k=(a(57),a(23)),_=a.n(k),y=(a(59),a(60),a(24)),w=a.n(y),C=a(25),O=a.n(C),S=a(26),j=a.n(S),P=a(27),N=a.n(P),x=a(28),R=a.n(x),T=a(29),D=a.n(T),F=a(30),I=a.n(F),M=a(31),A=a.n(M),z=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).UPLOAD_ENDPOINT="/api/v1/ayi/camera_capture",a.state={flag_takePhoto:1,flag_previewPhoto:0,flag_showResult:0,screenshot:"",result:"",tab:0,city:"sh",cities:["sh","gz"]},a.onSubmit=a.onSubmit.bind(Object(f.a)(a)),a.handleRetake=a.handleRetake.bind(Object(f.a)(a)),a.uploadFile=a.uploadFile.bind(Object(f.a)(a)),a.handleResult=a.handleResult.bind(Object(f.a)(a)),a._onCitySelect=a._onCitySelect.bind(Object(f.a)(a)),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"_onCitySelect",value:function(e){console.log(e.value),this.setState({city:e.value})}},{key:"handleRetake",value:function(){this.setState({screenshot:"",result:"",flag_takePhoto:1,flag_previewPhoto:0,flag_showResult:0})}},{key:"handleResult",value:function(){var e=this.state.city,t=this.state.result;if("sh"===e){if("\u53ef\u56de\u6536\u7269"===t)return r.a.createElement("img",{src:w.a,alt:"result"});if("\u5e72\u5783\u573e"===t||"\u5176\u4ed6\u5783\u573e"===t)return r.a.createElement("img",{src:O.a,alt:"result"});if("\u6709\u5bb3\u5783\u573e"===t)return r.a.createElement("img",{src:j.a,alt:"result"});if("\u6e7f\u5783\u573e"===t||"\u53a8\u4f59\u5783\u573e"===t)return r.a.createElement("img",{src:N.a,alt:"result"});if("\u4eba\u50cf"===t)return r.a.createElement("p",null,"\u4f60\u662f\u4ec0\u4e48\u5783\u573e\uff1f\uff01")}else{if("\u53ef\u56de\u6536\u7269"===t)return r.a.createElement("img",{src:R.a,alt:"result"});if("\u5e72\u5783\u573e"===t||"\u5176\u4ed6\u5783\u573e"===t)return r.a.createElement("img",{src:D.a,alt:"result"});if("\u6709\u5bb3\u5783\u573e"===t)return r.a.createElement("img",{src:I.a,alt:"result"});if("\u6e7f\u5783\u573e"===t||"\u53a8\u4f59\u5783\u573e"===t)return r.a.createElement("img",{src:A.a,alt:"result"});if("\u4eba\u50cf"===t)return r.a.createElement("p",null,"\u4f60\u662f\u4ec0\u4e48\u5783\u573e\uff1f\uff01")}}},{key:"onSubmit",value:function(){var e=Object(d.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,this.uploadFile(this.state.screenshot);case 4:a=e.sent,this.setState({result:a.data.comment,flag_takePhoto:0,flag_previewPhoto:0,flag_showResult:1}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"uploadFile",value:function(){var e=Object(d.a)(p.a.mark((function e(t){var a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.split(";base64,").pop(),(n=new FormData).append("image_string",a),n.append("city",this.state.city),e.next=6,b.a.post(this.UPLOAD_ENDPOINT,n,{headers:{"content-type":"multipart/form-data"}});case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTakePhoto",value:function(e){console.log("takePhoto"),this.setState({screenshot:e,flag_takePhoto:0,flag_previewPhoto:1,flag_showResult:0})}},{key:"onCameraError",value:function(e){console.error("onCameraError",e)}},{key:"onCameraStart",value:function(e){console.log("onCameraStart")}},{key:"onCameraStop",value:function(){console.log("onCameraStop")}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement("div",null),r.a.createElement("div",{className:"camera-container"},this.state.flag_takePhoto?r.a.createElement(E.a,{onTakePhoto:function(t){e.onTakePhoto(t)},onCameraError:function(t){e.onCameraError(t)},idealFacingMode:v.FACING_MODES.ENVIRONMENT,imageType:v.IMAGE_TYPES.JPG,imageCompression:.97,isMaxResolution:!1,isImageMirror:!1,onCameraStart:function(t){e.onCameraStart(t)},onCameraStop:function(){e.onCameraStop()}}):r.a.createElement("div",null)),r.a.createElement("div",{className:"result-container"},r.a.createElement("div",null,0===this.state.result.length?r.a.createElement("div",null):r.a.createElement("div",null,r.a.createElement("div",null,this.handleResult()),r.a.createElement("div",{className:"controls"},r.a.createElement("button",{onClick:this.handleRetake},"retake"))))),r.a.createElement("div",{className:"preview-container"},this.state.flag_previewPhoto?r.a.createElement("div",null,r.a.createElement("div",{className:"nav-control"},r.a.createElement("div",{className:"nav-control-tips"},"Please select city you are in: "),r.a.createElement(_.a,{options:this.state.cities,onChange:this._onCitySelect,value:this.state.cities[0],placeholder:"Select a city"})),r.a.createElement("div",{className:"screenshots"},this.state.screenshot?r.a.createElement("div",null,r.a.createElement("img",{src:this.state.screenshot,alt:"preview"})):r.a.createElement("div",null)),r.a.createElement("div",{className:"controls"},r.a.createElement("button",{onClick:this.handleRetake},"retake"),r.a.createElement("button",{onClick:this.onSubmit},"upload")),r.a.createElement("div",null,r.a.createElement("div",null))):null),r.a.createElement("div",null))}}]),t}(n.Component),G=(a(3),function(e){function t(){return Object(o.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(z,null))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(G,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[32,1,2]]]);
//# sourceMappingURL=main.a685e560.chunk.js.map